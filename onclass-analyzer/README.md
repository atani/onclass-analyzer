# オンクラス感想分析ツール マニュアル

## 概要

オンクラスの感想データを抽出・分析するためのツールセットです。

- **onclass-exporter**: Chrome拡張機能（感想データの抽出）
- **onclass-analyzer**: 分析ダッシュボード（データの可視化・PDF出力）

---

## 1. Chrome拡張機能のインストール

### 手順

1. Chromeで `chrome://extensions/` を開く
2. 右上の「デベロッパーモード」をONにする
3. 「パッケージ化されていない拡張機能を読み込む」をクリック
4. `onclass-exporter` フォルダを選択

### 確認

- 拡張機能一覧に「オンクラス感想エクスポーター」が表示されればOK

---

## 2. 感想データの抽出

### 手順

1. オンクラス管理画面にログイン
   ```
   https://manager.the-online-class.com/
   ```

2. 感想ページを開く
   - メニューから「感想」を選択

3. Chrome拡張機能のアイコンをクリック
   - ツールバーの拡張機能アイコン → 「オンクラス感想エクスポーター」

4. ポップアップで設定
   - **期間を指定**（任意）: 開始日〜終了日を選択
   - **エクスポート形式**: JSON（分析ツール用）を選択

5. 「全ページ一括取得」をクリック
   - 確認ダイアログで「OK」
   - 進捗バーが表示される（数分かかる場合あり）

6. 完了後、JSONファイルが自動ダウンロードされる
   - ファイル名例: `onclass-feedbacks-all-2026-01-09.json`

### 注意事項

- 取得中はブラウザを閉じない
- 334ページなど大量の場合は5〜10分かかる

---

## 3. 分析ダッシュボードの使用

### 起動方法

1. `onclass-analyzer/index.html` をブラウザで開く
   - ダブルクリック、または
   - ブラウザにドラッグ&ドロップ

### データの読み込み

1. JSONファイルをダッシュボードにドラッグ&ドロップ
   - または「クリックしてファイルを選択」

2. 自動的に分析が開始され、結果が表示される

---

## 4. コース別フィルター

### 使い方

ダッシュボード上部のボタンで表示するコースを切り替え:

| ボタン | 対象データ |
|--------|-----------|
| すべて | 全コース（テスト用除く） |
| JFYA | JFYAコースのみ |
| オンラインサロン | オンラインサロンのみ |
| SC養成講座 | 【13期】SC養成講座のみ |
| FC養成講座 | 【13期】FC養成講座のみ |
| PRE養成講座 | 【13期】PRE養成講座のみ |

### 表示される分析項目

- **基本統計**: 総感想数、ユニークユーザー数、平均感想長
- **感情分析**: ポジティブ/ニュートラル/改善要望の割合
- **改善要望の詳細**: カテゴリー別の改善要望とサンプル
- **人気ブロックランキング**: TOP10
- **カテゴリー別感想数**: 棒グラフ
- **コース別感想数**: ドーナツチャート
- **日別感想数の推移**: 折れ線グラフ
- **頻出キーワード**: ワードクラウド
- **アクティブユーザー**: 感想投稿数が多いユーザー
- **継続率分析**: リピーター率、ヘビーユーザー数

---

## 5. PDF出力

### 手順

1. コースフィルターで表示したいコースを選択
2. 右上の「PDFで保存」ボタンをクリック
3. PDFファイルが自動ダウンロードされる

### ファイル名

- `onclass-analysis-2026-01-09.pdf`（すべて）
- `onclass-analysis-jfya-2026-01-09.pdf`（JFYA）
- `onclass-analysis-salon-2026-01-09.pdf`（オンラインサロン）
- `onclass-analysis-sc-2026-01-09.pdf`（SC養成講座）
- `onclass-analysis-fc-2026-01-09.pdf`（FC養成講座）
- `onclass-analysis-pre-2026-01-09.pdf`（PRE養成講座）

### 全コース分を出力する場合

1. 「JFYA」→ PDF保存
2. 「オンラインサロン」→ PDF保存
3. 「SC養成講座」→ PDF保存
4. 「FC養成講座」→ PDF保存
5. 「PRE養成講座」→ PDF保存

---

## 6. コマンドライン分析（上級者向け）

詳細な施策レポートを生成する場合:

```bash
node analyze-courses.js
```

### 前提条件

- Node.jsがインストールされていること
- JSONファイルのパスをスクリプト内で指定

### 出力内容

- コース別の基本統計
- 人気ブロックTOP5
- ポジティブ/ネガティブキーワード分析
- 改善要望の具体例
- 改善施策の提案
- 全体サマリー

---

## 7. トラブルシューティング

### 拡張機能が動作しない

- オンクラス管理画面 (`manager.the-online-class.com`) 以外では動作しません
- ページを再読み込みしてから再度試す

### データが取得できない

- ログイン状態を確認
- 感想ページが正しく表示されているか確認

### PDFが生成できない

- ブラウザの印刷機能（Cmd+P / Ctrl+P）で代用可能

### 分析結果がおかしい

- JSONファイルが正しくエクスポートされているか確認
- 別のJSONファイルで試す

---

## 8. ファイル構成

```
onclass-exporter/          # Chrome拡張機能
├── manifest.json          # 拡張機能設定
├── content.js             # データ抽出スクリプト
├── popup.html             # ポップアップUI
└── popup.js               # ポップアップ処理

onclass-analyzer/          # 分析ダッシュボード
├── index.html             # ダッシュボードUI
├── analyzer.js            # 分析エンジン
├── analyze-courses.js     # CLI分析スクリプト
└── README.md              # このマニュアル
```

---

## 9. 定期運用フロー（推奨）

### 月次レポート作成

1. 月末にChrome拡張で感想データをエクスポート
2. 分析ダッシュボードで各コースのPDFを出力
3. 改善要望の多いコースを確認
4. 施策を検討・実施

### 推奨頻度

- **週次**: ダッシュボードで傾向をチェック
- **月次**: PDF出力して記録、施策検討
- **四半期**: 過去データと比較して改善効果を測定

---

## 更新履歴

- 2026-01-09: 初版作成
  - 5コース対応（JFYA、オンラインサロン、SC/FC/PRE養成講座）
  - コース別フィルター機能
  - 改善要望サマリー機能
  - PDF出力機能
